{"version":3,"sources":["../source/time ago.js"],"names":["resolve_locale","from_CLDR","Javascript_time_ago","locales","options","formatters","Array","isArray","concat","locale","style","input","locale_data","flavour","date","time","constructor","Date","getTime","Error","now","elapsed","override","undefined","units","filter","indexOf","unit","Math","abs","gradation","amount","get_formatters","formatter","default","current","previous_next","format","when","compile_formatters","formatter_messages","past_formatter_messages","past","future_formatter_messages","future","past_formatter","future_formatter","key","replace","message","default_formatter","previous","next","previous_next_message","default_locale","locale_parts","split","length","locale_try","join","pop","locale_data_map","main","long","data","converted","short","dates","fields","entry","converted_entry","test","subkey","prefix","converted_subkey"],"mappings":"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","file":"time ago.js","sourcesContent":["// a part of this code is adopted from\n// https://github.com/yahoo/intl-relativeformat/\n\nimport IntlMessageFormat from 'intl-messageformat'\nimport classify_elapsed  from './classify elapsed'\nimport style             from './style'\n\nexport default class Javascript_time_ago\n{\n\t// Fallback locale\n\t// (when not a single supplied preferred locale is available)\n\tstatic default_locale = 'en'\n\n\t// For all configured locales\n\t// their relative time formatter messages will be stored here\n\tstatic locale_data = {}\n\n\t// Relative time interval message formatters cache\n\tformatters = {}\n\n\tconstructor(locales, options)\n\t{\n\t\t// Make a copy of `locales` if it's an array, so that it doesn't change\n\t\t// since it's used lazily.\n\t\tif (Array.isArray(locales))\n\t\t{\n\t\t\tlocales = locales.concat()\n\t\t}\n\n\t\t// Choose the most appropriate locale\n\t\tthis.locale = resolve_locale(locales)\n\n\t\t// Is passed later on to `IntlMessageFormat`\n\t\tthis.locales = locales\n\n\t\t// Presets\n\t\tthis.style = style(locales)\n\t}\n\n\t// Formats the relative date.\n\t//\n\t// Returns: a string\n\t//\n\t// Parameters:\n\t//\n\t//    options - (optional)\n\t//\n\t//       units     - a list of allowed time units\n\t//                   (e.g. ['second', 'minute', 'hour', …])\n\t//\n\t//       gradation - time scale gradation steps.\n\t//                   (e.g.\n\t//                   [\n\t//                      { unit: 'second', factor: 1 }, \n\t//                      { unit: 'minute', factor: 60, threshold: 60 },\n\t//                      …\n\t//                   ])\n\t//\n\t//       override - function ({ elapsed, time, date, now })\n\t//\n\t//                  If the `override` function returns a value,\n\t//                  then the `.format()` call will return that value.\n\t//                  Otherwise it has no effect.\n\t//\n\tformat(input, options = {})\n\t{\n\t\t// Get locale messages for this formatting flavour\n\t\tconst { flavour, locale_data } = this.locale_data(options.flavour)\n\n\t\tlet date\n\t\tlet time\n\t\t\n\t\tif (input.constructor === Date)\n\t\t{\n\t\t\tdate = input\n\t\t\ttime = input.getTime()\n\t\t}\n\t\telse if (typeof input === 'number')\n\t\t{\n\t\t\ttime = input\n\t\t\tdate = new Date(input)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error(`Unsupported relative time formatter input: ${typeof input}, ${input}`)\n\t\t}\n\n\t\t// can pass a custom `now` for testing purpose\n\t\tconst now = options.now || Date.now()\n\n\t\t// how much time elapsed (in seconds)\n\t\tconst elapsed = (now - time) / 1000 // in seconds\n\n\t\t// Allows output customization.\n\t\t// For example, seconds, minutes and hours can be shown relatively,\n\t\t// and other intervals can be shown using full date format.\n\t\t// (see Twitter style)\n\t\tif (options.override)\n\t\t{\n\t\t\tconst override = options.override({ elapsed, time, date, now })\n\t\t\tif (override !== undefined)\n\t\t\t{\n\t\t\t\treturn override\n\t\t\t}\n\t\t}\n\n\t\t// Available time interval measurement units\n\t\tlet units = Object.keys(locale_data)\n\n\t\tif (options.units)\n\t\t{\n\t\t\t// Find available time interval measurement units\n\t\t\tunits = options.units.filter(unit => units.indexOf(unit) >= 0)\n\t\t}\n\n\t\t// Choose the appropriate time measurement unit \n\t\t// and get the corresponding rounded time amount\n\t\tconst { unit, amount } = classify_elapsed(Math.abs(elapsed), units, options.gradation)\n\n\t\t// If no time unit is suitable, just output empty string\n\t\tif (!unit)\n\t\t{\n\t\t\treturn ''\n\t\t}\n\n\t\t// format the message for the chosen time measurement unit\n\t\t// (second, minute, hour, day, etc)\n\n\t\tconst formatters = this.get_formatters(unit, flavour)\n\n\t\t// default formatter: \"X units\"\n\t\tlet formatter = formatters.default\n\n\t\t// in case of \"0 units\"\n\t\tif (amount === 0 && formatters.current)\n\t\t{\n\t\t\tformatter = formatters.current\n\t\t}\n\n\t\t// in case of \"previous unit\" or \"next unit\"\n\t\tif ((amount === -1 || amount === 1) && formatters.previous_next)\n\t\t{\n\t\t\tformatter = formatters.previous_next\n\t\t}\n\n\t\t// return formatted time amount\n\t\treturn formatter.format\n\t\t({\n\t\t\t'0'  : amount,\n\t\t\twhen : elapsed >= 0 ? 'past' : 'future'\n\t\t})\n\t}\n\n\t// Gets locale messages for this formatting flavour\n\tlocale_data(flavour)\n\t{\n\t\t// Get relative time formatter messages for this locale\n\t\tconst locale_data = Javascript_time_ago.locale_data[this.locale]\n\n\t\t// Fallback to \"default\" flavour if the given flavour isn't available\n\t\tif (!flavour || !locale_data[flavour])\n\t\t{\n\t\t\tflavour = 'default'\n\t\t}\n\n\t\treturn { flavour, locale_data: locale_data[flavour] }\n\t}\n\n\t// lazy creation of a formatter for a given time measurement unit\n\t// (second, minute, hour, day, etc)\n\tget_formatters(unit, flavour)\n\t{\n\t\tif (!this.formatters[flavour])\n\t\t{\n\t\t\tthis.formatters[flavour] = {}\n\t\t}\n\n\t\tconst formatters = this.formatters[flavour]\n\n\t\t// Create a new synthetic message based on the locale data from CLDR.\n\t\tif (!formatters[unit])\n\t\t{\n\t\t\tformatters[unit] = this.compile_formatters(unit, flavour)\n\t\t}\n\n\t\treturn formatters[unit]\n\t}\n\n\t// compiles formatter for the specified time measurement unit \n\t// (second, minute, hour, day, etc)\n\tcompile_formatters(unit, flavour)\n\t{\n\t\t// Locale specific time interval formatter messages\n\t\t// for the given time interval measurement unit\n\t\tconst formatter_messages = Javascript_time_ago.locale_data[this.locale][flavour][unit]\n\n\t\t// Locale specific time interval formatter messages\n\t\t// for the given time interval measurement unit\n\t\t// for \"past\" and \"future\"\n\t\t//\n\t\t// (e.g.\n\t\t//  {\n\t\t//   \"relativeTimePattern-count-one\": \"{0} second ago\",\n\t\t//   \"relativeTimePattern-count-other\": \"{0} seconds ago\"\n\t\t//  })\n\t\t//\n\t\tconst past_formatter_messages   = formatter_messages.past\n\t\tconst future_formatter_messages = formatter_messages.future\n\n\t\t// `format.js` number formatter messages\n\t\t// e.g. \"one {# second ago} other {# seconds ago}\"\n\t\tlet past_formatter   = ''\n\t\tlet future_formatter = ''\n\n\t\t// Compose \"past\" formatter specification\n\t\t// (replacing CLDR number placeholder \"{0}\" \n\t\t//  with format.js number placeholder \"#\")\n\t\tfor (let key of Object.keys(past_formatter_messages))\n\t\t{\n\t\t\tpast_formatter += ` ${key} \n\t\t\t\t\t{${past_formatter_messages[key].replace('{0}', '#')}}`\n\t\t}\n\n\t\t// Compose \"future\" formatter specification\n\t\t// (replacing CLDR number placeholder \"{0}\" \n\t\t//  with format.js number placeholder \"#\")\n\t\tfor (let key of Object.keys(future_formatter_messages))\n\t\t{\n\t\t\t// e.g. += \" one {# sec. ago}\"\n\t\t\tfuture_formatter += ` ${key} \n\t\t\t\t\t{${future_formatter_messages[key].replace('{0}', '#')}}`\n\t\t}\n\n\t\t// The ultimate time interval `format.js` specification\n\t\t// (\"0\" will be replaced with the first argument\n\t\t//  when the message will be formatted)\n\t\tconst message = `{ when, select, past   {{0, plural, ${past_formatter}}}\n\t\t                                 future {{0, plural, ${future_formatter}}} }`\n\n\t\t// Create the synthetic IntlMessageFormat instance \n\t\t// using the original locales specified by the user\n\t\tconst default_formatter = new IntlMessageFormat(message, this.locales)\n\n\t\tconst formatters = \n\t\t{\n\t\t\tdefault: default_formatter\n\t\t}\n\n\t\t// \"0 units\" formatter\n\t\tif (formatter_messages.current)\n\t\t{\n\t\t\tformatters.current =\n\t\t\t{\n\t\t\t\tformat: () => formatter_messages.current\n\t\t\t}\n\t\t}\n\n\t\t// \"previous unit\" and \"next unit\" formatter\n\t\tif (formatter_messages.previous && formatter_messages.next)\n\t\t{\n\t\t\tconst previous_next_message = `{ when, select, past   {${formatter_messages.previous}}\n\t\t\t                                               future {${formatter_messages.next}} }`\n\t\t\n\t\t\t// Create the synthetic IntlMessageFormat instance \n\t\t\t// using the original locales specified by the user\n\t\t\tformatters.previous_next = new IntlMessageFormat(previous_next_message, this.locales)\n\t\t}\n\n\t\treturn formatters\n\t}\n}\n\n// Chooses the most appropriate locale \n// based on the list of preferred locales supplied by the user\nexport function resolve_locale(locales)\n{\n\t// Suppose it's an array\n\tif (typeof locales === 'string')\n\t{\n\t\tlocales = [locales]\n\t}\n\n\t// Create a copy of the array so we can push on the default locale.\n\tlocales = (locales || []).concat(Javascript_time_ago.default_locale)\n\n\t// Using the set of locales + the default locale, we look for the first one\n\t// which that has been registered. When data does not exist for a locale, we\n\t// traverse its ancestors to find something that's been registered within\n\t// its hierarchy of locales. Since we lack the proper `parentLocale` data\n\t// here, we must take a naive approach to traversal.\n\tfor (let locale of locales)\n\t{\n\t\tconst locale_parts = locale.split('-')\n\n\t\twhile (locale_parts.length)\n\t\t{\n\t\t\tconst locale_try = locale_parts.join('-')\n\n\t\t\tif (Javascript_time_ago.locale_data[locale_try])\n\t\t\t{\n\t\t\t\t// Return the normalized locale string; \n\t\t\t\t// e.g., we return \"en-US\",\n\t\t\t\t// instead of \"en-us\".\n\t\t\t\treturn locale_try\n\t\t\t}\n\n\t\t\tlocale_parts.pop()\n\t\t}\n\t}\n\n\tthrow new Error(`No locale data has been added for any of the locales: ${locales.join(', ')}`)\n}\n\n// Adds locale data\nJavascript_time_ago.locale = function(locale_data)\n{\n\tlet locale\n\tlet locale_data_map\n\n\tif (!locale_data)\n\t{\n\t\tthrow new Error(`The passed in locale data is undefined`)\n\t}\n\n\tif (locale_data.main)\n\t{\n\t\tlocale = Object.keys(locale_data.main)[0]\n\n\t\t// Convert from CLDR format\n\t\tlocale_data_map = from_CLDR(locale_data)\n\t}\n\telse\n\t{\n\t\tlocale = locale_data.locale\n\n\t\tlocale_data_map = {}\n\n\t\t// Supports multiple locale variations\n\t\t// (e.g. \"default\", \"short\", \"normal\", \"long\", etc)\n\t\tfor (let key of Object.keys(locale_data))\n\t\t{\n\t\t\tif (key !== 'locale')\n\t\t\t{\n\t\t\t\tlocale_data_map[key] = locale_data[key]\n\t\t\t}\n\t\t}\n\t}\n\n\t// Guard against malformed input\n\tif (!locale)\n\t{\n\t\tthrow new Error(`Couldn't determine locale for this locale data. Make sure the \"locale\" property is present.`)\n\t}\n\n\t// Ensure default formatting flavour is set\n\tif (!locale_data_map.default)\n\t{\n\t\tlocale_data_map.default = locale_data_map.long || locale_data_map[Object.keys(locale_data_map)[0]]\n\t}\n\n\t// Store locale specific messages in the static variable\n\tJavascript_time_ago.locale_data[locale] = locale_data_map\n\n\t// (will be added manually by this library user)\n\t// // Add locale data to IntlMessageFormat\n\t// // (to be more specific: the `pluralRuleFunction`)\n\t// require('intl-messageformat/locale-data/ru')\n}\n\n// Converts locale data from CLDR format (if needed)\nexport function from_CLDR(data)\n{\n\t// the usual time measurement units\n\tconst units = ['second', 'minute', 'hour', 'day', 'week', 'month', 'year']\n\n\t// result\n\tconst converted = { long: {} }\n\n\t// detects the short flavour of labels (yr., mo., etc)\n\tconst short = /-short$/\n\n\tconst locale = Object.keys(data.main)[0]\n\tdata = data.main[locale].dates.fields\n\n\tfor (let key of Object.keys(data))\n\t{\n\t\t// take only the usual time measurement units\n\t\tif (units.indexOf(key) < 0 && units.indexOf(key.replace(short, '')) < 0)\n\t\t{\n\t\t\tcontinue\n\t\t}\n\n\t\tconst entry = data[key]\n\t\tconst converted_entry = {}\n\n\t\t// if a key ends with `-short`, then it's a \"short\" flavour\n\t\tif (short.test(key))\n\t\t{\n\t\t\tif (!converted.short)\n\t\t\t{\n\t\t\t\tconverted.short = {}\n\t\t\t}\n\n\t\t\tconverted.short[key.replace(short, '')] = converted_entry\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconverted.long[key] = converted_entry\n\t\t}\n\n\t\t// the \"relative\" values aren't suitable for \"ago\" or \"in a\" cases,\n\t\t// because \"1 year ago\" != \"last year\"\n\n\t\t// if (entry['relative-type--1'])\n\t\t// {\n\t\t// \tconverted_entry.previous = entry['relative-type--1']\n\t\t// }\n\n\t\t// if (entry['relative-type-0'])\n\t\t// {\n\t\t// \tconverted_entry.current = entry['relative-type-0']\n\t\t// }\n\n\t\t// if (entry['relative-type-1'])\n\t\t// {\n\t\t// \tconverted_entry.next = entry['relative-type-1']\n\t\t// }\n\n\t\tif (entry['relativeTime-type-past'])\n\t\t{\n\t\t\tconst past = entry['relativeTime-type-past']\n\t\t\tconverted_entry.past = {}\n\n\t\t\tfor (let subkey of Object.keys(past))\n\t\t\t{\n\t\t\t\tconst prefix = 'relativeTimePattern-count-'\n\t\t\t\tconst converted_subkey = subkey.replace(prefix, '')\n\n\t\t\t\tconverted_entry.past[converted_subkey] = past[subkey]\n\t\t\t}\n\t\t}\n\n\t\tif (entry['relativeTime-type-future'])\n\t\t{\n\t\t\tconst future = entry['relativeTime-type-future']\n\t\t\tconverted_entry.future = {}\n\n\t\t\tfor (let subkey of Object.keys(future))\n\t\t\t{\n\t\t\t\tconst prefix = 'relativeTimePattern-count-'\n\t\t\t\tconst converted_subkey = subkey.replace(prefix, '')\n\n\t\t\t\tconverted_entry.future[converted_subkey] = future[subkey]\n\t\t\t}\n\t\t}\n\t}\n\n\treturn converted\n}"]}